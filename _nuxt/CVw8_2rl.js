import{_ as xt}from"./Dn_pGXxb.js";import{_ as nt,a as yt,b as wt}from"./CTCpnBxu.js";import{bq as kt,e as b,r as E,L as st,s as Ct,br as Tt,ac as ot,bj as K,a as at,ae as St,i as u,f as _,l as t,g as p,w as v,h as c,O as M,j as C,Q as $,bs as At,F as Q,m as J,t as g,aa as P,bt as $t,W as ct,a2 as Nt,an as Pt,ao as It,T as rt,aj as Mt,k as X,al as Y,a6 as Ft}from"./Tyql0LRw.js";import{i as it,c as lt,u as tt}from"./DkocL5JY.js";import{_ as Lt,a as Rt}from"./Dcy40L1A.js";import{_ as Et,a as Ot}from"./UdrvS0Mz.js";import{u as Bt,a as jt}from"./CEvEHNh7.js";import{u as Vt}from"./-Br2tCzY.js";import{a as zt,u as Dt}from"./yobR4Vdo.js";import{s as Wt}from"./x_rD_Ya3.js";import{u as Ht}from"./J4dZJS1r.js";import"./DGfu_dD2.js";async function qt(e,n={}){var d,i;let s;if(n.connector)s=n.connector;else{const{connections:r,current:o}=e.state,h=r.get(o);s=h==null?void 0:h.connector}const l=e.state.connections;s&&(await s.disconnect(),s.emitter.off("change",e._internal.events.change),s.emitter.off("disconnect",e._internal.events.disconnect),s.emitter.on("connect",e._internal.events.connect),l.delete(s.uid)),e.setState(r=>{if(l.size===0)return{...r,connections:new Map,current:void 0,status:"disconnected"};const o=l.values().next().value;return{...r,connections:new Map(l),current:o.connector.uid}});{const r=e.state.current;if(!r)return;const o=(d=e.state.connections.get(r))==null?void 0:d.connector;if(!o)return;await((i=e.storage)==null?void 0:i.setItem("recentConnectorId",o.id))}}let N=[];function R(e){const n=[...e.state.connections.values()];return e.state.status==="reconnecting"||it(N,n)?N:(N=n,n)}function Gt(e,n){const{onChange:s}=n;return e.subscribe(()=>R(e),s,{equalityFn:it})}function Zt(e){return{mutationFn(n){return qt(e,n)},mutationKey:["disconnect"]}}function Ut(e={}){const n=lt(e),s=kt(R(n));return Gt(n,{onChange(){s.value=R(n)}}),s}function Kt(e={}){const{mutation:n}=e,s=lt(e),l=Zt(s),{mutate:d,mutateAsync:i,...r}=zt({...n,...l});return{...r,connectors:b(()=>Ut({config:s}).value.map(o=>o.connector)),disconnect:d,disconnectAsync:i}}const F=100n,et=E(0n),L=E({value:0n,timestamp:0}),Qt=()=>{const e=st(),{epoch:n}=Ct(e),s=Ht(),l=b(()=>{var o;return((o=e.epoch.current)==null?void 0:o.type)==="TRANSFER"}),d=()=>{const o=n.value.current.end.timestamp-n.value.current.asTimestamp;return Array.from(Array(Number(F+1n)).keys()).map((h,x)=>{const T=BigInt(o)/F*BigInt(x);return{x:n.value.current.asTimestamp+Number(T),y:Jt(x,F)}})},i=async()=>{if(!l.value)return 0n;try{const o=await K(s,{address:e.contracts.powerToken,functionName:"getCost",args:[1n]});if(o===L.value.value)return;L.value={value:o||0n,timestamp:Math.floor(new Date().getTime()/1e3)}}catch(o){console.log(o)}};async function r(){try{et.value=await K(s,{address:e.contracts.powerToken,functionName:"amountToAuction"})}catch(o){console.log(o)}}return Tt(()=>{i(),r()}),Wt(()=>{l.value&&i()},5e3),ot(l,()=>{i(),r()}),{amountLeftToAuction:et,currentCost:L,getPricePoints:d,getCurrentCost:i,getAmountLeftToAuction:r}};function Jt(e,n){return 1n<<n-BigInt(e)-1n}const f=e=>(Pt("data-v-5c0720a2"),e=e(),It(),e),Xt={class:"h-full flex flex-col"},Yt={class:"flex items-end gap-4 leading-4 pt-16 lg:pt-8 mb-6 z-50"},te=f(()=>t("img",{class:"h-[24px]",src:nt,alt:""},null,-1)),ee=f(()=>t("span",{class:"text-grey-500 text-sm font-ppformula text-nowrap"}," [ Governance ] ",-1)),ne={class:"h-full overflow-y-scroll lg:overflow-y-auto flex flex-col gap-3"},se={class:"flex flex-col gap-3"},oe={class:"text-grey-100 mb-3 lg:mb-6"},ae={key:0,class:"text-grey-100"},ce=f(()=>t("hr",{class:"border-grey-700 my-4"},null,-1)),re={class:"text-grey-100 mb-3 lg:mb-6"},ie={key:0,class:"mb-4 bg-grey-800 p-4 font-inter"},le=f(()=>t("div",{class:"text-xxs text-grey-500 flex justify-between"},[t("span",null,"Voting power"),t("span",null,"Balance")],-1)),ue=f(()=>t("hr",{class:"border-grey-700 border-dashed mb-4 mt-2"},null,-1)),de=f(()=>t("p",{class:"text-xs mb-2 text-grey-500"},"POWER tokens",-1)),pe={class:"flex justify-between items-end gap-3"},_e={class:"flex gap-2 items-end"},me={class:"text-grey-200 font-ppformula leading-3"},fe={class:"text-grey-200 text-xxs leading-none"},he=f(()=>t("hr",{class:"border-grey-700 border-dashed my-4"},null,-1)),ge=f(()=>t("p",{class:"text-xs mb-2 text-grey-500"},"ZERO tokens",-1)),ve={class:"flex justify-between items-end gap-3"},be={class:"flex gap-2 items-end"},xe={class:"text-grey-200 font-ppformula leading-3"},ye={class:"text-grey-200 text-xxs leading-none"},we={key:1,class:"mb-4 bg-grey-800 p-4"},ke={class:"bg-red-500 text-white w-fit p-2 text-xs"},Ce=f(()=>t("br",null,null,-1)),Te=at({__name:"LayoutSidebar",setup(e){const{isConnected:n,address:s}=Bt(),{disconnect:l}=Kt(),{isCorrectChain:d,forceSwitchChain:i}=Dt(),{amountLeftToAuction:r}=Qt(),o=st(),h=St(),{currentRoute:x}=h,T=b(()=>{var m;return((m=o.epoch.current)==null?void 0:m.type)==="TRANSFER"}),ut=$t(),{power:dt,zero:pt}=Vt(s),{powerToken:_t,zeroToken:mt}=jt(s),I=b(()=>ut.public.auctionActive),y=b(()=>I.value!==!0),O=b(()=>I.value===!0||I.value===""),ft=b(()=>[{title:"Home",path:"/proposals/",isShow:y.value,dataTest:"sidebar-link-proposals"},{title:"Actors",path:"/actors/",isShow:y.value,dataTest:"sidebar-link-lists"},{title:"Configs",path:"/config/",isShow:y.value,dataTest:"sidebar-link-configs"},{title:"Auction",path:"/auction/",isShow:O.value,dataTest:"sidebar-link-auction",notification:r.value&&T.value},{title:"Protocol Fees",path:"/fees/",isShow:O.value,dataTest:"sidebar-link-fees"}]),ht=b(()=>[{title:"My Profile",path:"/profile/me/",isShow:y.value,dataTest:"sidebar-link-my-profile"}]);return(m,S)=>{var j,V,z,D,W,H,q,G,Z,U;const A=ct,B=Nt,gt=Et,vt=Lt,bt=Rt;return u(),_("div",Xt,[t("div",Yt,[p(A,{to:"/"},{default:v(()=>[te]),_:1}),ee]),t("div",ne,[t("div",null,[t("div",se,[c(n)?$("",!0):(u(),M(gt,{key:0},{default:v(({connect:a})=>[p(B,{class:"w-full flex justify-center","data-test":"sidebar-button-connect-wallet",onClick:a},{default:v(()=>[C(" Connect Wallet ")]),_:2},1032,["onClick"])]),_:1})),c(y)?(u(),M(A,{key:1,class:"block",to:"/proposal/create/"},{default:v(()=>[p(B,{disabled:(m._.provides[At]||m.$route).path==="/proposal/create/",class:"mb-6 w-full flex justify-center","data-test":"sidebar-button-create-proposal",version:c(n)?"primary":"outline-light"},{default:v(()=>[C(" Create Proposal ")]),_:1},8,["disabled","version"])]),_:1})):$("",!0)]),t("nav",oe,[t("ul",null,[(u(!0),_(Q,null,J(c(ft).filter(a=>a.isShow),a=>{var w,k;return u(),_("li",{key:a.path},[p(A,{to:a.path,class:P({"notification-dot":a.notification,active:(k=(w=c(x))==null?void 0:w.path)==null?void 0:k.includes(a.path)}),"data-test":a.dataTest},{default:v(()=>[C(g(a.title)+" "+g(),1)]),_:2},1032,["to","class","data-test"])])}),128))])])]),c(n)?(u(),_("div",ae,[ce,t("nav",re,[t("ul",null,[(u(!0),_(Q,null,J(c(ht),a=>{var w,k;return u(),_("li",{key:a.to},[a.isShow?(u(),M(A,{key:0,to:a.path,class:P({"notification-dot":a==null?void 0:a.notification,active:(k=(w=c(x))==null?void 0:w.path)==null?void 0:k.includes(a.path)}),"data-test":a.dataTest},{default:v(()=>[C(g(a.title)+" "+g(),1)]),_:2},1032,["to","class","data-test"])):$("",!0)])}),128))])]),c(d)?(u(),_("div",ie,[le,ue,de,t("div",null,[t("div",pe,[t("div",_e,[p(vt,{class:"h-4 w-4",version:"light"}),t("span",me,g((z=(V=(j=c(dt))==null?void 0:j.data.value)==null?void 0:V.relative)==null?void 0:z.toFixed(3))+"% ",1)]),t("span",fe,g(("useNumberFormatterPrice"in m?m.useNumberFormatterPrice:c(tt))(((W=(D=c(_t))==null?void 0:D.data.value)==null?void 0:W.formatted)||0n,0,2)),1)])]),he,ge,t("div",null,[t("div",ve,[t("div",be,[p(bt,{version:"light",class:"h-4 w-4"}),t("span",xe,g((G=(q=(H=c(pt))==null?void 0:H.data.value)==null?void 0:q.relative)==null?void 0:G.toFixed(3))+"% ",1)]),t("span",ye,g(("useNumberFormatterPrice"in m?m.useNumberFormatterPrice:c(tt))(((U=(Z=c(mt))==null?void 0:Z.data.value)==null?void 0:U.formatted)||0n,0,0)),1)])])])):(u(),_("div",we,[t("p",ke,[C(" Wrong network!"),Ce,t("button",{class:"text-xxs underline hover:no-underline",onClick:S[0]||(S[0]=(...a)=>c(i)&&c(i)(...a))}," Switch network ")])])),t("button",{id:"button-disconnect-wallet",type:"button",class:"block w-full my-4 hover:underline text-left text-xs font-ppformula","data-test":"sidebar-button-disconnect",onClick:S[1]||(S[1]=()=>c(l)())}," Disconnect ")])):$("",!0)])])}}}),Se=rt(Te,[["__scopeId","data-v-5c0720a2"]]),Ae=Mt("/img/mobile/burguer-toggle.svg"),$e={class:"flex items-center justify-between z-50 p-6 lg:pl-16"},Ne={class:"flex items-end gap-4 leading-4"},Pe=t("img",{class:"h-[24px]",src:nt,alt:""},null,-1),Ie=t("span",{class:"text-grey-500 text-sm leading-3"},"Gov",-1),Me={class:"flex lg:hidden"},Fe=t("span",{class:"sr-only"},"Toggle main manu",-1),Le={"aria-hidden":"true"},Re={src:Ae,alt:"Menu"},Ee={src:Ot,alt:"Close"},Oe={__name:"LayoutHeader",props:{sidebarOpen:{type:Boolean,default:!1}},emits:["toggle-sidebar"],setup(e,{emit:n}){const s=n,l=e;return(d,i)=>{const r=ct;return u(),_("header",$e,[t("div",Ne,[p(r,{to:"/proposals"},{default:v(()=>[Pe]),_:1}),Ie]),t("div",Me,[t("button",{"data-test":"header-button-toggle-sidebar",onClick:i[0]||(i[0]=o=>s("toggle-sidebar"))},[Fe,t("span",Le,[X(t("img",Re,null,512),[[Y,!l.sidebarOpen]]),X(t("img",Ee,null,512),[[Y,l.sidebarOpen]])])])])])}}},Be={class:"flex flex-col h-full"},je={class:"flex flex-col h-dvh"},Ve={class:"flex grow xl:gap-6"},ze=at({__name:"default",setup(e){const n=E(!1),s=Ft();return ot(()=>s.path,()=>{n.value=!1},{deep:!0,immediate:!0}),(l,d)=>{const i=Oe,r=Se,o=yt,h=xt,x=wt;return u(),_("div",Be,[p(i,{class:"w-full bg-grey-900 lg:hidden fixed lg:static","sidebar-open":c(n),onToggleSidebar:d[0]||(d[0]=T=>n.value=!c(n))},null,8,["sidebar-open"]),t("div",je,[t("div",Ve,[t("aside",{class:P({"!block":c(n)})},[p(r)],2),t("main",{class:P([{"!hidden":c(n)},"w-full lg:max-w-[1100px] overflow-x-hidden lg:p-6 pt-24 lg:pt-12"])},[p(o),p(h)],2)]),p(x)])])}}}),tn=rt(ze,[["__scopeId","data-v-e10bb04e"]]);export{tn as default};
