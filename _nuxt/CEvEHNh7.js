import{i as O,c as I,f as A,d as C,h as F,e as E}from"./DkocL5JY.js";import{bI as N,aZ as B,bJ as P,bK as v,aF as R,b1 as x,bL as K,bM as Q,V as q,bN as m,$ as S,bg as U,bE as $,e as j,h as k,L as p,s as h,r as w}from"./Tyql0LRw.js";function M(t){return typeof t=="number"?t:t==="wei"?0:Math.abs(N[t])}async function z(t,n){const{allowFailure:e=!0,chainId:a,contracts:d,...s}=n,r=t.getClient({chainId:a});return B(r,P,"multicall")({allowFailure:e,contracts:d,...s})}async function L(t,n){const{allowFailure:e=!0,blockNumber:a,blockTag:d,...s}=n,r=n.contracts;try{const c=r.reduce((o,l,y)=>{const b=l.chainId??t.state.chainId;return{...o,[b]:[...o[b]||[],{contract:l,index:y}]}},{}),u=()=>Object.entries(c).map(([o,l])=>z(t,{...s,allowFailure:e,blockNumber:a,blockTag:d,chainId:parseInt(o),contracts:l.map(({contract:y})=>y)})),i=(await Promise.all(u())).flat(),f=Object.values(c).flatMap(o=>o.map(({index:l})=>l));return i.reduce((o,l,y)=>(o&&(o[f[y]]=l),o),[])}catch(c){if(c instanceof v)throw c;const u=()=>r.map(i=>R(t,{...i,blockNumber:a,blockTag:d}));return e?(await Promise.allSettled(u())).map(i=>i.status==="fulfilled"?{result:i.value,status:"success"}:{error:i.reason,result:void 0,status:"failure"}):await Promise.all(u())}}async function Z(t,n){const{address:e,blockNumber:a,blockTag:d,chainId:s,token:r,unit:c="ether"}=n;if(r)try{return T(t,{balanceAddress:e,chainId:s,symbolType:"string",tokenAddress:r})}catch(l){if(l instanceof v){const y=await T(t,{balanceAddress:e,chainId:s,symbolType:"bytes32",tokenAddress:r}),b=x(K(y.symbol,{dir:"right"}));return{...y,symbol:b}}throw l}const u=t.getClient({chainId:s}),f=await B(u,Q,"getBalance")(a?{address:e,blockNumber:a}:{address:e,blockTag:d}),o=t.chains.find(l=>l.id===s)??u.chain;return{decimals:o.nativeCurrency.decimals,formatted:q(f,M(c)),symbol:o.nativeCurrency.symbol,value:f}}async function T(t,n){const{balanceAddress:e,chainId:a,symbolType:d,tokenAddress:s,unit:r}=n,c={abi:[{type:"function",name:"balanceOf",stateMutability:"view",inputs:[{type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"decimals",stateMutability:"view",inputs:[],outputs:[{type:"uint8"}]},{type:"function",name:"symbol",stateMutability:"view",inputs:[],outputs:[{type:d}]}],address:s},[u,i,f]=await L(t,{allowFailure:!1,contracts:[{...c,functionName:"balanceOf",args:[e],chainId:a},{...c,functionName:"decimals",chainId:a},{...c,functionName:"symbol",chainId:a}]}),o=q(u??"0",M(r??i));return{decimals:i,formatted:o,symbol:f,value:u}}function _(t,n){const{onChange:e}=n;return t.subscribe(()=>m(t),e,{equalityFn(a,d){const{connector:s,...r}=a,{connector:c,...u}=d;return O(r,u)&&(s==null?void 0:s.id)===(c==null?void 0:c.id)&&(s==null?void 0:s.uid)===(c==null?void 0:c.uid)}})}function D(t,n){Object.keys(t).forEach(e=>{t[e]=n[e]})}function et(t={}){const n=I(t),e=S(m(n));return _(n,{onChange(){D(e,m(n))}}),U($(e))}function J(t,n={}){return{async queryFn({queryKey:e}){const{address:a,scopeKey:d,...s}=e[1];if(!a)throw new Error("address is required");return await Z(t,{...s,address:a})??null},queryKey:V(n)}}function V(t={}){return["balance",A(t)]}function g(t={}){const n=I(t),e=C(),a=j(()=>{const{config:d,...s}=k(t),r=E(s),c=J(n,{...r,chainId:r.chainId??k(e)}),{address:u,query:i={}}=r,f=!!(u&&(i.enabled??!0));return{...i,...c,enabled:f}});return F(a)}const G=t=>{const n=p(),e=h(n),a=w(t);return g({address:a,token:e.contracts.value.cashToken,query:{enabled:!0}})},H=t=>{const n=p(),e=h(n),a=w(t);return g({address:a,token:e.contracts.value.powerToken,query:{enabled:!0}})},W=t=>{const n=p(),e=h(n),a=w(t);return g({address:a,token:e.contracts.value.zeroToken,query:{enabled:!0}})},X=t=>{const n=G(t),e=H(t),a=W(t);return{cashToken:n,powerToken:e,zeroToken:a,refetch:()=>{e.refetch(),a.refetch(),n.refetch()}}},nt=X;export{nt as a,g as b,et as u};
